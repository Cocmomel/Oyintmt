<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <title>Miniapp O‚Äòyinlar</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f2f2f2;
    }
    .balance {
      position: fixed;
      top: 10px;
      right: 10px;
      background: #222;
      color: #fff;
      padding: 8px 15px;
      border-radius: 10px;
      font-weight: bold;
    }
    .menu {
      margin-top: 80px;
    }
    button {
      display: block;
      margin: 15px auto;
      padding: 15px 30px;
      font-size: 18px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background: #4caf50;
      color: white;
    }
    .game {
      display: none;
      margin-top: 40px;
    }
    input {
      padding: 10px;
      font-size: 16px;
      width: 200px;
    }
  </style>
</head>
<body>
  <div class="balance">üí∞ Balans: <span id="balance">100000</span> so‚Äòm</div>

  <div class="menu">
    <button onclick="openGame('rps')">üéÆ Tosh‚ÄìQaychi‚ÄìQog‚Äòoz</button>
    <button onclick="openGame('cards')">üÉè Karta O‚Äòyini</button>
    <button onclick="openGame('slot')">üé∞ Mevalar (Slot)</button>
  </div>

  <!-- RPS o'yini -->
  <div id="rps" class="game">
    <h2>Tosh ‚Äì Qaychi ‚Äì Qog‚Äòoz</h2>
    <input type="number" id="betRps" placeholder="Garov (500‚Äì1000000)">
    <br><br>
    <button onclick="playRps('Tosh')">Tosh</button>
    <button onclick="playRps('Qaychi')">Qaychi</button>
    <button onclick="playRps('Qog‚Äòoz')">Qog‚Äòoz</button>
    <p id="rpsResult"></p>
  </div>

  <!-- Karta o'yini -->
  <div id="cards" class="game">
    <h2>Karta O‚Äòyini</h2>
    <input type="number" id="betCards" placeholder="Garov (500‚Äì1000000)">
    <br><br>
    <button onclick="playCards('Qizil')">Qizil</button>
    <button onclick="playCards('Qora')">Qora</button>
    <button onclick="playCards('Chilliq')">Chilliq</button>
    <button onclick="playCards('G‚Äòisht')">G‚Äòisht</button>
    <button onclick="playCards('Tappon')">Tappon</button>
    <p id="cardsResult"></p>
  </div>

  <!-- Slot o'yini -->
  <div id="slot" class="game">
    <h2>üé∞ Mevalar (Slot)</h2>
    <input type="number" id="betSlot" placeholder="Garov (500‚Äì1000000)">
    <br><br>
    <button onclick="playSlot()">Garov qo‚Äòyish</button>
    <p id="slotResult"></p>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand(); // Telegram ichida to‚Äòliq ekran
    let balance = 100000; // default balans

    // Agar kelajakda botdan foydalanuvchi balansini olsak:
    // balance = tg.initDataUnsafe?.userBalance || 100000;

    function updateBalance() {
      document.getElementById('balance').innerText = balance;
    }

    function openGame(id) {
      document.querySelectorAll('.game').forEach(g => g.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    // --- RPS ---
    function playRps(choice) {
      let bet = parseInt(document.getElementById('betRps').value);
      if (!bet || bet < 500 || bet > 1000000 || bet > balance) return alert("Noto‚Äòg‚Äòri garov!");
      let options = ["Tosh","Qaychi","Qog‚Äòoz"];
      let bot = options[Math.floor(Math.random()*3)];
      let result = "";
      if (choice===bot) result="Durrang, pul qaytarildi.";
      else if (
        (choice==="Tosh" && bot==="Qaychi") ||
        (choice==="Qaychi" && bot==="Qog‚Äòoz") ||
        (choice==="Qog‚Äòoz" && bot==="Tosh")
      ) { balance+=bet; result="Siz yutdingiz! +" + bet; }
      else { balance-=bet; result="Yutqazdingiz! -" + bet; }
      updateBalance();
      document.getElementById('rpsResult').innerText=`Siz: ${choice}, Bot: ${bot} ‚Üí ${result}`;
    }

    // --- Cards ---
    function playCards(choice) {
      let bet = parseInt(document.getElementById('betCards').value);
      if (!bet || bet < 500 || bet > 1000000 || bet > balance) return alert("Noto‚Äòg‚Äòri garov!");
      let options = ["Qizil","Qora","Chilliq","G‚Äòisht","Tappon"];
      let card = options[Math.floor(Math.random()*5)];
      let result="";
      if (choice===card) {
        let mult = (choice==="Qizil"||choice==="Qora") ? 2 : 4;
        balance += bet*mult;
        result=`Siz yutdingiz! ${mult}x ‚Üí +${bet*mult}`;
      } else {
        balance -= bet;
        result=`Yutqazdingiz! -${bet}`;
      }
      updateBalance();
      document.getElementById('cardsResult').innerText=`Siz: ${choice}, Chiqqan: ${card} ‚Üí ${result}`;
    }

    // --- Slot ---
    function playSlot() {
      let bet = parseInt(document.getElementById('betSlot').value);
      if (!bet || bet < 500 || bet > 1000000 || bet > balance) return alert("Noto‚Äòg‚Äòri garov!");
      let symbols = ["üçí","üçã","üçä","üçâ","7"];
      let spin = [symbols[Math.floor(Math.random()*5)],
                  symbols[Math.floor(Math.random()*5)],
                  symbols[Math.floor(Math.random()*5)]];
      let res = spin.join(" ");
      let mult = 0;

      if (spin[0]==="7" && spin[1]==="7" && spin[2]==="7") mult=100;
      else if (spin[0]==spin[1] && spin[1]===spin[2]) mult=10;
      else mult = Math.random()<0.5 ? 0 : 2;

      if (mult>0) balance += bet*mult;
      else balance -= bet;

      document.getElementById('slotResult').innerText=`${res} ‚Üí ${mult>0 ? `Siz yutdingiz! ${mult}x = +${bet*mult}` : `Yutqazdingiz! -${bet}`}`;
      updateBalance();
    }

    updateBalance();
  </script>
</body>
</html>
